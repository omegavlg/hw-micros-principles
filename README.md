
# Домашнее задание к занятию "`Микросервисы: принципы`" - `Дедюрин Денис`

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

### Ответ:

#### Сравнение API Gateway

| Решение         | Kong       | NGINX (с модулем API Gateway) | Traefik    | Envoy      | AWS API Gateway | KrakenD    |
|----------------|-----------|-----------------------------|------------|------------|-----------------|------------|
| Маршрутизация запросов | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| Аутентификация | ✅ | ⚠️ (через внешний модуль) | ⚠️ (OIDC, OAuth2) | ✅ | ✅ | ✅ |
| SSL/TLS        | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| Развертывание  | On-premise | On-premise | On-cloud | On-premise | On-cloud | On-premise |

Выбор решения:

Если требуется гибкость, простая настройка и высокая производительность, хорошим вариантом будет **Kong**, так как он поддерживает все необходимые требования и имеет плагины для расширенной функциональности.

Если проект использует **Kubernetes**, то **Traefik** или **Envoy** будут лучшими вариантами, так как они динамически адаптируются к изменениям в среде.

Если инфраструктура построена на **AWS**, то логичнее использовать **AWS API Gateway**, так как он обеспечивает нативную интеграцию с сервисами **AWS**.

Выбор: **Kong**, так как он отвечает всем требованиям, легко расширяется, поддерживает интеграцию с различными сервисами аутентификации и имеет широкое комьюнити.

---
## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

### Ответ:

#### Сравнение брокеров сообщений

| Решение            | Кластеризация | Хранение сообщений на диске | Высокая скорость | Форматы сообщений | Разделение прав доступа | Простота эксплуатации |
|-------------------|---------------|-----------------------------|------------------|--------------------|-------------------------|-----------------------|
| **RabbitMQ**      | ✅ Да          | ✅ Да (на диске)             | ✅ Высокая        | JSON, XML, AMQP    | ✅ Да (с использованием RBAC) | ✅ Простая настройка, хорошая документация |
| **Apache Kafka**  | ✅ Да          | ✅ Да (на диске)             | ✅ Очень высокая  | JSON, Avro, Protobuf | ✅ Да (с использованием ACL) | ✅ Хорошая масштабируемость, требует настройки |
| **ActiveMQ**      | ✅ Да          | ✅ Да (на диске)             | ✅ Высокая        | JSON, XML, AMQP    | ✅ Да (с использованием ACL) | ⚠️ Требует больше ресурсов для масштабирования |
| **Amazon SQS**    | ✅ Да (в облаке) | ✅ Да (с сохранением на диске) | ✅ Высокая        | JSON               | ✅ Да (с использованием IAM) | ✅ Простота эксплуатации, полностью управляемое решение |

Обоснование выбора:

**Apache Kafka** — это лучшее решение, если вам нужна высокая скорость работы и масштабируемость. **Kafka** имеет встроенную поддержку кластеризации, обеспечивает надёжность благодаря сохранению сообщений на диске, поддерживает различные форматы сообщений (JSON, Avro, Protobuf) и предоставляет возможность гибкого разделения прав доступа через ACL. Это решение хорошо подходит для больших и высоконагруженных систем.

**RabbitMQ** — хороший выбор, если вы ищете простоту эксплуатации и поддержку стандартных форматов сообщений, таких как JSON и XML. Он также поддерживает кластеризацию, но его производительность может уступать Kafka при работе с большими объемами данных.

**Amazon SQS** — идеален, если вам нужно полностью управляемое облачное решение с хорошей поддержкой кластеризации и хранения сообщений. Однако, это решение может быть не таким гибким, как Kafka или RabbitMQ.

**ActiveMQ** — подходящее решение для менее высоконагруженных систем, где важна стабильность и поддержка различных форматов сообщений. **ActiveMQ** поддерживает кластеризацию и хранение сообщений на диске, что делает его надежным решением для большинства приложений. Однако для очень высоких нагрузок и масштабируемости его настройка может потребовать дополнительных усилий. Для системы средней или низкой нагрузки, где важно гибкое разделение прав доступа, **ActiveMQ** может быть хорошим выбором.

Выбор: **Apache Kafka**. Это решение предоставляет все необходимые возможности для работы с большим объёмом данных, высокой скоростью работы и гибким разделением прав доступа.
