
# Домашнее задание к занятию "`Микросервисы: принципы`" - `Дедюрин Денис`

Вы работаете в крупной компании, которая строит систему на основе микросервисной архитектуры.
Вам как DevOps-специалисту необходимо выдвинуть предложение по организации инфраструктуры для разработки и эксплуатации.

## Задача 1: API Gateway 

Предложите решение для обеспечения реализации API Gateway. Составьте сравнительную таблицу возможностей различных программных решений. На основе таблицы сделайте выбор решения.

Решение должно соответствовать следующим требованиям:
- маршрутизация запросов к нужному сервису на основе конфигурации,
- возможность проверки аутентификационной информации в запросах,
- обеспечение терминации HTTPS.

Обоснуйте свой выбор.

### Ответ:

#### Сравнение API Gateway

| Решение         | Kong       | NGINX (с модулем API Gateway) | Traefik    | Envoy      | AWS API Gateway | KrakenD    |
|----------------|-----------|-----------------------------|------------|------------|-----------------|------------|
| Маршрутизация запросов | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| Аутентификация | ✅ | ⚠️ (через внешний модуль) | ⚠️ (OIDC, OAuth2) | ✅ | ✅ | ✅ |
| SSL/TLS        | ✅ | ✅ | ✅ | ✅ | ✅ | ✅ |
| Развертывание  | On-premise | On-premise | On-cloud | On-premise | On-cloud | On-premise |

Выбор решения:

Если требуется гибкость, простая настройка и высокая производительность, хорошим вариантом будет **Kong**, так как он поддерживает все необходимые требования и имеет плагины для расширенной функциональности.

Если проект использует **Kubernetes**, то **Traefik** или **Envoy** будут лучшими вариантами, так как они динамически адаптируются к изменениям в среде.

Если инфраструктура построена на **AWS**, то логичнее использовать **AWS API Gateway**, так как он обеспечивает нативную интеграцию с сервисами **AWS**.

Выбор: **Kong**, так как он отвечает всем требованиям, легко расширяется, поддерживает интеграцию с различными сервисами аутентификации и имеет широкое комьюнити.

---
## Задача 2: Брокер сообщений

Составьте таблицу возможностей различных брокеров сообщений. На основе таблицы сделайте обоснованный выбор решения.

Решение должно соответствовать следующим требованиям:
- поддержка кластеризации для обеспечения надёжности,
- хранение сообщений на диске в процессе доставки,
- высокая скорость работы,
- поддержка различных форматов сообщений,
- разделение прав доступа к различным потокам сообщений,
- простота эксплуатации.

Обоснуйте свой выбор.

### Ответ:

#### Сравнение брокеров сообщений

| Решение            | Кластеризация | Хранение сообщений на диске | Высокая скорость | Форматы сообщений | Разделение прав доступа | Простота эксплуатации |
|-------------------|---------------|-----------------------------|------------------|--------------------|-------------------------|-----------------------|
| **RabbitMQ**      | ✅ Да          | ✅ Да (на диске)             | ✅ Высокая        | JSON, XML, AMQP    | ✅ Да (с использованием RBAC) | ✅ Простая настройка, хорошая документация |
| **Apache Kafka**  | ✅ Да          | ✅ Да (на диске)             | ✅ Очень высокая  | JSON, Avro, Protobuf | ✅ Да (с использованием ACL) | ✅ Хорошая масштабируемость, требует настройки |
| **ActiveMQ**      | ✅ Да          | ✅ Да (на диске)             | ✅ Высокая        | JSON, XML, AMQP    | ✅ Да (с использованием ACL) | ⚠️ Требует больше ресурсов для масштабирования |
| **Amazon SQS**    | ✅ Да (в облаке) | ✅ Да (с сохранением на диске) | ✅ Высокая        | JSON               | ✅ Да (с использованием IAM) | ✅ Простота эксплуатации, полностью управляемое решение |
| **NATS**          | ⚠️ Нет         | ✅ Да (на диске)             | ✅ Очень высокая  | JSON, CBOR         | ✅ Да (с использованием NATS Authorization) | ⚠️ Более сложная настройка кластеризации |
| **Redis Streams** | ⚠️ Нет         | ✅ Да (с использованием RDB) | ✅ Очень высокая  | JSON, Message Pack | ✅ Да (с использованием Redis ACL) | ✅ Очень быстрый, требует настройки кластеризации |


